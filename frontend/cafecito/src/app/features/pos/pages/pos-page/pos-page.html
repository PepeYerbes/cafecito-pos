<section class="layout">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="brand">
      <span class="logo">â˜•</span>
      <div class="title">
        <div class="name">POS</div>
        <small class="muted">Caja y Ventas</small>
      </div>
    </div>

    <nav class="nav">
      <a routerLink="/pos" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }">
        ğŸ§¾ Punto de venta
      </a>
      <a routerLink="/pos/open-shift" routerLinkActive="active">ğŸ”“ Abrir caja</a>
      <a routerLink="/pos/close-shift" routerLinkActive="active">ğŸ”’ Cerrar caja</a>
      <a routerLink="/catalogo" routerLinkActive="active">ğŸ—‚ï¸ CatÃ¡logo</a>
      <a routerLink="/config" routerLinkActive="active">âš™ï¸ ConfiguraciÃ³n</a>
      <a routerLink="/pos/shift-history" routerLinkActive="active">ğŸ“œ Historial cierres</a>
      <a routerLink="/customers" routerLinkActive="active">ğŸ‘¥ Clientes</a>
    </nav>

    <div class="session">
      <ng-container *ngIf="!loadingCash(); else loadingTpl">
        <div *ngIf="hasOpenSession(); else closedTpl" class="badge open">Caja abierta</div>
        <ng-template #closedTpl><div class="badge closed">Caja cerrada</div></ng-template>
      </ng-container>

      <div class="actions">
        <button class="btn" (click)="goOpenShift()">Abrir</button>
        <button class="btn outline" (click)="goCloseShift()">Cerrar</button>
      </div>
    </div>
  </aside>

  <!-- Contenido principal -->
  <main class="content">
    <header class="topbar">
      <h1>Punto de venta</h1>
      <span class="muted" *ngIf="cash(); else noCash">SesiÃ³n activa</span>
      <ng-template #noCash><span class="muted">Sin sesiÃ³n</span></ng-template>
    </header>

    <div class="workspace">
      <!-- Productos -->
      <section class="pane">
        <ng-container *ngIf="!loadingProducts(); else loadingTpl2">
          <app-product-grid [productos]="productos()" (add)="addProduct($event)"></app-product-grid>
        </ng-container>
        <ng-template #loadingTpl2><div class="muted">Cargando productosâ€¦</div></ng-template>
      </section>

      <!-- Carrito / Totales / Cliente -->
      <section class="pane narrow">
        <app-customer-picker (select)="setCustomer($event)"></app-customer-picker>
        <app-cart></app-cart>
        <app-totals (checkout)="onCheckout()"></app-totals>
      </section>
    </div>
  </main>
</section>

<ng-template #loadingTpl>
  <div class="muted">Verificando estado de cajaâ€¦</div>
</ng-template>